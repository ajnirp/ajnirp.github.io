<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Rohan Prinja</title>
  <meta name="description" content="loriculus.org">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Rohan Prinja">
  <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700"> -->
  <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata"> -->
  <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open Sans"> -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400" rel="stylesheet">

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js"></script>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/mathtex-script-type.min.js" integrity="sha384-zWYbd0NBwgTsgIdFKVprSfTh1mbMPe5Hz1X3yY4Sd1h/K1cQoUe36OGwAGz/PcDy" crossorigin="anonymous"></script>
      
    
  

  <link rel="stylesheet" type="text/css" href="/main.css">
</head>

 <header id="header">
  <div id="home"><a href="/">Home</a></div>
  <div id="header-links">
    <ul>
      <li><a href="https://loriculus.org/blog/">Blog</a></li>
      <li><a href="https://loriculus.org/research/">Research</a></li>
    </ul>
  </div>
</header>

<body>
  <section class="section">
    <div class="container">
      

<h1 class="title">Solving Project Euler #45</h1>

<p class=post-date>Nov 14 2025</p>


  <h2>Table of contents</h2>
  <ul>
  
    <li>
      <a href="https://loriculus.org/blog/euler-45/#introduction">Introduction</a>
      
    </li>
  
    <li>
      <a href="https://loriculus.org/blog/euler-45/#problem-statement">Problem statement</a>
      
    </li>
  
    <li>
      <a href="https://loriculus.org/blog/euler-45/#sketching-out-a-solution">Sketching out a solution</a>
      
        <ul>
          
              <li>
                  <a href="https://loriculus.org/blog/euler-45/#expressing-t-in-terms-of-h">Expressing t in terms of h</a>
              </li>
          
              <li>
                  <a href="https://loriculus.org/blog/euler-45/#expressing-p-in-terms-of-h">Expressing p in terms of h</a>
              </li>
          
        </ul>
      
    </li>
  
    <li>
      <a href="https://loriculus.org/blog/euler-45/#coding-it-up">Coding it up</a>
      
    </li>
  
    <li>
      <a href="https://loriculus.org/blog/euler-45/#conclusion">Conclusion</a>
      
    </li>
  
  </ul>


<h2 id="introduction">Introduction</h2>
<p><a href="https://projecteuler.net">Project Euler</a> is a repository of fantastic computational problems that require a modest to heavy degree of mathematical thinking. As someone who enjoys programming and math, I love Project Euler. In this post we'll discuss a solution to a fun problem of theirs that I solved the other day, <a href="https://projecteuler.net/problem=45">problem 45</a>.</p>
<p>But first, a disclaimer:</p>
<div role="warning">
From the Project Euler <a href=https://projecteuler.net>FAQ</a>: "[...] the rule about sharing solutions outside of Project Euler does not apply to <b>the first one-hundred problems</b>, as long as any discussion clearly aims to instruct methods, not just provide answers, and does not directly threaten to undermine the enjoyment of solving later problems. Problems 1 to 100 provide a wealth of helpful introductory teaching material and if you are able to respect our requirements, then we give permission for those problems and their solutions to be discussed elsewhere."
</div>
<p>Emphasis mine. With that noted, let's discuss the problem.</p>
<h2 id="problem-statement">Problem statement</h2>
<p>Triangle, pentagonal, and hexagonal numbers are generated by the following formulae:</p>
<script type="math/tex;mode=display">T_n = n(n + 1)/2 \\
P_n = n(3n - 1)/2 \\
H_n = n(2n - 1) \\</script>
<p>where <script type="math/tex">n</script> is a positive integer. So, for example, <script type="math/tex">T_1 = P_1 = H_1 = 1</script>.</p>
<p>It can be verified that <script type="math/tex">T_{285} = P_{165} = H_{143} = 40755</script>.</p>
<div role="highlight">Find the next triangle number that is also pentagonal and hexagonal.</div>
<p>Feel free to try and solve this yourself in another tab. Maybe you'll end up with a different solution than mine, in which case I'd love to hear about it ðŸ™‚</p>
<h2 id="sketching-out-a-solution">Sketching out a solution</h2>
<p>We have two equations in three variables, and some very useful domain constraints. Let's say the <script type="math/tex">t^{th}</script> triangular number equals the <script type="math/tex">p^{th}</script> pentagonal number equals the <script type="math/tex">h^{th}</script> hexagonal number. And so:</p>
<script type="math/tex;mode=display">T_t = H_h \\
P_p = H_h</script>
<p>We also have some useful domain constraints. <script type="math/tex">t, p, h</script> are positive integers, which gives us these inequalities</p>
<script type="math/tex;mode=display">t \ge 0 \\
p \ge 0 \\
h \ge 0</script>
<p>Expand out the equations:</p>
<script type="math/tex;mode=display">t(t + 1)/2 = h(2h - 1) \\
p(3p - 1)/2 = h(2h - 1)</script><h3 id="expressing-t-in-terms-of-h">Expressing <code>t</code> in terms of <code>h</code></h3>
<p>Let's focus on the first one:</p>
<script type="math/tex;mode=display">t(t + 1)/2 = h(2h - 1) \\
\implies t(t + 1) = 2h(2h - 1) \\
\implies t(t + 1) = (2h - 1)2h \\
\implies t(t + 1) = (2h - 1)((2h - 1) + 1) \\
\implies t(t + 1) = u(u + 1)</script>
<p>where <script type="math/tex">u \coloneqq 2h - 1</script>. The only way for two integers <script type="math/tex">u, t</script> to satisfy that last equation while both being positive is for them to be equal to each other, and so we get <script type="math/tex">t = u = 2h - 1</script>.</p>
<p>We've turned one of our variables into a function of the other, <script type="math/tex">t = 2h - 1</script>! Let's do the same for <script type="math/tex">p</script>.</p>
<h3 id="expressing-p-in-terms-of-h">Expressing <code>p</code> in terms of <code>h</code></h3>
<script type="math/tex;mode=display">p(3p - 1)/2 = h(2h - 1) \\
\implies p(3p - 1) = 2h(2h - 1) \\
\implies 3p^2 - 3p + (2h - 4h^2) = 0 \\</script>
<p>The final step above was me expanding out all the brackets and pushing everything over to the left. I also kept the parens around the last two terms on the left because I wanted to make the equation look like â€” you guessed it â€” a quadratic equation in <script type="math/tex">p</script>.</p>
<p>Let's apply the quadratic formula:</p>
<script type="math/tex;mode=display">p = \frac{-1 \pm \sqrt{1 - 4.3.(2h - 4h^2)}}{2.3} = \frac{-1 \pm \sqrt{1 + 12(4h^2 - 2h)}}{6}</script>
<p>Note that I flipped the order of the terms inside the parens around so I could get rid of the negative sign outside the parens.</p>
<p>There are two solutions here, but we can discard the one that looks like
<script type="math/tex;mode=display">\frac{-1 - \sqrt{stuff}}{6}</script></p>
<p>because it's negative! To see why, note that the denominator is positive and both terms in the numerator are negative.</p>
<p>And so we get a one-to-one mapping from <script type="math/tex">h</script> to <script type="math/tex">p</script>:</p>
<script type="math/tex;mode=display">p = \frac{-1 + \sqrt{1 + 12(4h^2 - 2h)}}{6}</script>
<p>This is way messier than the earlier mapping <script type="math/tex">t = 2h - 1</script>. But now we have enough to write our solver program.</p>
<h2 id="coding-it-up">Coding it up</h2>
<p>Here's some Python code that implements our search for the next solution:</p>
<pre data-linenos data-lang="python" style="background-color:#fcf0ca;color:#282828aa;" class="language-python "><code class="language-python" data-lang="python"><table><tbody><tr><td>1</td><td><span style="color:#9d0006;">from </span><span>math </span><span style="color:#9d0006;">import </span><span>sqrt
</span></td></tr><tr><td>2</td><td><span>
</span></td></tr><tr><td>3</td><td><span style="color:#9d0006;">def </span><span style="color:#407959;">sqrt_discriminant</span><span>(</span><span style="color:#282828;">m</span><span>):
</span></td></tr><tr><td>4</td><td><span>    </span><span style="color:#9d0006;">return </span><span style="color:#282828;">sqrt(</span><span style="color:#8f3f71;">12</span><span style="color:#b23c15;">*</span><span style="color:#282828;">(</span><span style="color:#8f3f71;">4</span><span style="color:#b23c15;">*</span><span style="color:#282828;">m</span><span style="color:#b23c15;">*</span><span style="color:#282828;">m </span><span style="color:#b23c15;">- </span><span style="color:#8f3f71;">2</span><span style="color:#b23c15;">*</span><span style="color:#282828;">m) </span><span style="color:#b23c15;">+ </span><span style="color:#8f3f71;">1</span><span style="color:#282828;">)
</span></td></tr><tr><td>5</td><td><span>
</span></td></tr><tr><td>6</td><td><span style="color:#9d0006;">def </span><span style="color:#407959;">nth_triangle_num</span><span>(</span><span style="color:#282828;">n</span><span>):
</span></td></tr><tr><td>7</td><td><span>    </span><span style="color:#9d0006;">return </span><span>n</span><span style="color:#b23c15;">*</span><span>(n</span><span style="color:#b23c15;">+</span><span style="color:#8f3f71;">1</span><span>)</span><span style="color:#b23c15;">//</span><span style="color:#8f3f71;">2
</span></td></tr><tr><td>8</td><td><span>
</span></td></tr><tr><td>9</td><td><span>h </span><span style="color:#b23c15;">= </span><span style="color:#8f3f71;">144
</span></td></tr><tr><td>10</td><td><span style="color:#9d0006;">while </span><span style="color:#8f3f71;">True</span><span>:
</span></td></tr><tr><td>11</td><td><span>    s </span><span style="color:#b23c15;">= </span><span style="color:#282828;">sqrt_discriminant(h)
</span></td></tr><tr><td>12</td><td><span>    </span><span style="color:#9d0006;">if </span><span style="color:#b57614;">int</span><span style="color:#282828;">(s) </span><span style="color:#b23c15;">== </span><span>s:
</span></td></tr><tr><td>13</td><td><span>        numerator </span><span style="color:#b23c15;">= </span><span style="color:#b57614;">int</span><span style="color:#282828;">(s) </span><span style="color:#b23c15;">+ </span><span style="color:#8f3f71;">1
</span></td></tr><tr><td>14</td><td><span>        </span><span style="color:#9d0006;">if </span><span>numerator </span><span style="color:#b23c15;">% </span><span style="color:#8f3f71;">6 </span><span style="color:#b23c15;">== </span><span style="color:#8f3f71;">0</span><span>:
</span></td></tr><tr><td>15</td><td><span>            t </span><span style="color:#b23c15;">= </span><span style="color:#8f3f71;">2</span><span style="color:#b23c15;">*</span><span>h </span><span style="color:#b23c15;">- </span><span style="color:#8f3f71;">1
</span></td></tr><tr><td>16</td><td><span>            p </span><span style="color:#b23c15;">= </span><span>numerator </span><span style="color:#b23c15;">// </span><span style="color:#8f3f71;">6
</span></td></tr><tr><td>17</td><td><span>            </span><span style="color:#b57614;">print</span><span style="color:#282828;">(nth_triangle_num(t))
</span></td></tr><tr><td>18</td><td><span>            </span><span style="color:#9d0006;">break
</span></td></tr><tr><td>19</td><td><span>    h </span><span style="color:#b23c15;">+= </span><span style="color:#8f3f71;">1
</span></td></tr></tbody></table></code></pre>
<p>We're doing a simple linear search starting from <script type="math/tex">h = 144</script>, because, as the problem requires, we're searching for the next solution after <script type="math/tex">h = 143</script>. Within our search, we ignore all values of <script type="math/tex">h</script> for which the expression</p>
<script type="math/tex;mode=display">p = \frac{-1 + \sqrt{1 + 12(4h^2 - 2h)}}{6}</script>
<p>is not an integer. For it to be an integer:</p>
<ul>
<li>the numerator must be an integer</li>
<li>...and it must be divisible by <script type="math/tex">6</script>.</li>
</ul>
<p>For the numerator to be an integer, the quantity <script type="math/tex">1 + 12(4h^2 - 2h)</script> must be a perfect square. That's what the <code>int(s) == s</code> check is for. The rest is pretty straightforward â€” once we find a value for <script type="math/tex">h</script> that yields an integer value for <script type="math/tex">p</script>, we find the corresponding value of <script type="math/tex">t</script>, print the values and then break out of our otherwise-infinite <code>while</code> loop.</p>
<p>The above code spits out an answer almost immediately on my laptop.</p>
<p>An aside: it feels like overkill to use the Python standard library's <code>math.sqrt</code> function just to check if a number is a perfect square. As it turns out, we don't need to use it! You can always write an integer sqrt implementation that uses binary search to find the square root of a positive integer, rounded down to the nearest integer, and then check that squaring <em>that</em> integer equals our original number. I leave this as an exercise to the reader.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I hope you enjoyed this dissection of a not-terribly-difficult but nevertheless very enjoyable problem. Thank you for reading!</p>
<p><strong>P.S.</strong> Hover to reveal the answer, if you're curious: <span class="spoiler">the next triangle number that is also pentagonal and hexagonal is 1533776805</span>.</p>


<div id="link-to-top"><a href="#">Back to the top</a></div>


    </div>
  </section>
</body>

</html>